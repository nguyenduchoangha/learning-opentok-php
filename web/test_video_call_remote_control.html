<html>

<body>
    <p id="mic">MIC?</p>
    <script src="https://static.opentok.com/v2/js/opentok.js" charset="utf-8"></script>
    <script charset="utf-8">
        var apiKey = "45839292";
        var sessionId = "2_MX40NTgzOTI5Mn5-MTQ5NDM5NzI1NzY1N35LWlZLSmVLdEdRUDQzVmkxajlkdk5YL3N-fg";
        var token = "T1==cGFydG5lcl9pZD00NTgzOTI5MiZzaWc9N2ZmNDhkZTFhNmM0NWVmYWY4YWExNmNlZDA1MzMyODE5YzcyYjY5NzpzZXNzaW9uX2lkPTJfTVg0ME5UZ3pPVEk1TW41LU1UUTVORE01TnpJMU56WTFOMzVMV2xaTFNtVkxkRWRSVURRelZta3hhamxrZGs1WUwzTi1mZyZjcmVhdGVfdGltZT0xNDk1MDkxNzU2Jm5vbmNlPTAuNzA0MzQ0NDE4MzAxOTg4MiZyb2xlPXB1Ymxpc2hlciZleHBpcmVfdGltZT0xNDk1Njk2NTU1";
        var session = OT.initSession(apiKey, sessionId)
            .on('streamCreated', function (event) {
                session.subscribe(event.stream, 'subscriber', {
                    insertMode: 'append',
                    width: '100%',
                    height: '100%',
                });
            })
            .connect(token, function (error) {
                var publisher = OT.initPublisher('publisher', {
                    insertMode: 'append',
                    width: '100%',
                    height: '100%',
                    audioSource: "default"
                });
                session.publish(publisher);

            });

        function err_function(error) {
            if (error) {
                console.log("signal error ("
                    + error.name
                    + "): " + error.message);
            } else {
                console.log("signal sent.");
            }
        }

        document.addEventListener("keypress", function (event) {
            console.log(event.key)
            session.signal({ data: event.key, type:"key" }, err_function);
        });
    </script>

    <div>
    <div><span>Control Your Turtlebot!</span></div>
    <div><span>---------------------------</span></div>
    <div><span>Moving around:</span></div>
    <div><span> u i o</span></div>
    <div><span> j k l</span></div>
    <div><span> m , .</span></div>
    <br />
    <div><span>q/z : increase/decrease max speeds by 10%</span></div>
    <div><span>w/x : increase/decrease only linear speed by 10%</span></div>
    <div><span>e/c : increase/decrease only angular speed by 10%</span></div>
    <div><span>space key, k : force stop</span></div>
    <div><span>anything else : stop smoothly</span></div>
    <div id="videos">
        <div id="subscriber"></div>
        <div id="publisher"></div>
    </div>
    </div>
</body>
<style>
body, html {
    background-color: gray;
    height: 100%;
}

#videos {
    position: relative;
    width: 100%;
    height: 100%;
    margin-left: auto;
    margin-right: auto;
}

#subscriber {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
}

#publisher {
    position: absolute;
    width: 360px;
    height: 240px;
    bottom: 10px;
    right: 10px;
    z-index: 100;
    border: 3px solid white;
    border-radius: 3px;
}
</style>

</html>
